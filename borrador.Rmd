---
title: "borrador"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(tidyverse)
library(rgdal)
library(lubridate)
library(forcats)
library(dplyr)
library(foreign)
library(xtable)
library(ggplot2)

B2015 <- read.spss("D:\\Trabajo-Final-Turismo-Receptivo/R15.sav", to.data.frame = TRUE)
na.omit(2015)


t4.2015 <- read.spss("D:\\Trabajo-Final-Turismo-Receptivo/R4T15.sav", to.data.frame = TRUE)
na.omit(t4.2015)

  
```



VISITANTES INGRESADOS A URUGUAY, POR ZONA DE DESTINO, ESTADIA Y GASTO

```{r, echo=FALSE, results='asis'}

options(xtable.comment = FALSE)
by_Destino <- B2015  %>%  mutate(Gasto= GTotal*coef) %>% mutate(Gente1= Gente*coef) %>% dplyr::select(Destino, Gente1, Estadia, Gasto) %>% group_by(Destino) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))

destino <-  by_Destino %>% mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias ) %>% mutate(value = (n/sum(n))*100) %>% xtable()

destino2 <- destino %>% mutate(Porcentaje = (n/sum(n))*100)

count <- by_Destino %>% dplyr::select(Destino,n) 


print(xtable(destino))

ggplot(destino)+
  geom_col(aes(Destino,n,fill=Destino))+
  labs(y="Cantidad de visitantes")+ coord_flip()+ theme(legend.position="none")

ggplot(destino)+
  geom_col(aes(Destino,dias))+
  coord_polar()

ggplot(destino)+
  geom_col(aes(Destino,Gastos))
ggplot(destino)+geom_col(aes(Destino,Gastos_PDia))

ggplot(destino)+ geom_col(aes(Destino,Gastos_P))
```




```{r, echo=FALSE}

x <- destino %>% select(Destino,value) %>% gather(Destino,value)

x %>% ggplot() + geom_col(aes(x=fct_reorder(Destino,value, .desc = TRUE), y= value)) + coord_flip()+theme(legend.position="none")+labs(x = "Zona de destino", y = "Poroporción de turistas")+ theme_classic() 
```


VISITANTES INGRESADOS A URUGUAY, POR NACIONALIDAD, ESTADIA Y GASTO

```{r,echo= FALSE, results='asis'} 

options(xtable.comment = FALSE)

 by_Nac <- t4.2015  %>%  mutate(Gasto= GTotal*coef) %>%  mutate(Gente1= Gente*coef) %>% select(Nac, Gente1, Estadia, Gasto) %>% group_by(Nac) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))
 
 nacionalidad <- by_Nac %>% mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias ) %>% xtable()

print(xtable(nacionalidad))
 
```

VISITANTES INGRESADOS A URUGUAY, POR ALOJAMIENTO UTILIZADO, ESTADIA Y GASTO

```{r,echo= FALSE, results='asis'} 

 by_Aloja <- t4.2015  %>% mutate(Gente1= Gente*coef) %>%  mutate(Gasto= GTotal*coef) %>% select(Aloja, Gente1, Estadia, Gasto) %>% group_by(Aloja) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))
 
alojamiento <- by_Aloja %>%  mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias )%>% xtable()

print(xtable(alojamiento))
 
 
```

VISITANTES INGRESADOS A URUGUAY, POR ZONA DE INGRESO, ESTADIA Y GASTO

```{r,echo=FALSE, results='asis'}
options(xtable.comment = FALSE)

 x <-  by_Entro <- t4.2015  %>% mutate(Gente1= Gente*coef) %>% select(Entro, Gente1) %>% group_by(Entro) %>% summarise(n= sum(Gente1)) %>% xtable()
 
 print(xtable(x))
 
```
