---
title: "borrador"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE}
library(dplyr)
library(foreign)
library(xtable)
library(ggplot2)

t4.2015 <- read.spss("D:\\Trabajo-Final-Turismo-Receptivo/R4T15.sav", to.data.frame = TRUE)
  
```



VISITANTES INGRESADOS A URUGUAY, POR ZONA DE DESTINO, ESTADÍA Y GASTO

```{r, echo=FALSE, results='asis'}
options(xtable.comment = FALSE)
by_Destino <- t4.2015  %>%  mutate(Gasto= GTotal*coef) %>% mutate(Gente1= Gente*coef) %>% select(Destino, Gente1, Estadia, Gasto) %>% group_by(Destino) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))

destino <-  by_Destino %>% mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias ) %>% xtable()

print(xtable(destino))

ggplot(destino)+
  geom_col(aes(Destino,n))+
  labs(y="Cantidad de visitantes")

ggplot(destino)+
  geom_col(aes(Destino,dias))+
  coord_polar()

ggplot(destino)+
  geom_col(aes(Destino,Gastos))

ggplot(destino)+
  geom_col(aes(Destino,Gastos_P))

ggplot(destino)+
  geom_col(aes(Destino,Gastos_PDia))

ggplot(destino)+
  geom_point(aes(dias,n,color=Destino, size=1))+
  labs(y="Cantidad de visitantes")

ggplot(destino)+
  geom_point(aes(Gastos_P,dias,color=Destino))
```


VISITANTES INGRESADOS A URUGUAY, POR NACIONALIDAD, ESTADÍA Y GASTO

```{r,echo= FALSE, results='asis'} 

options(xtable.comment = FALSE)

 by_Nac <- t4.2015  %>%  mutate(Gasto= GTotal*coef) %>%  mutate(Gente1= Gente*coef) %>% select(Nac, Gente1, Estadia, Gasto) %>% group_by(Nac) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))
 
 nacionalidad <- by_Nac %>% mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias ) %>% xtable()

print(xtable(nacionalidad))
 
```

VISITANTES INGRESADOS A URUGUAY, POR ALOJAMIENTO UTILIZADO, ESTADÍA Y GASTO

```{r,echo= FALSE, results='asis'} 

 by_Aloja <- t4.2015  %>% mutate(Gente1= Gente*coef) %>%  mutate(Gasto= GTotal*coef) %>% select(Aloja, Gente1, Estadia, Gasto) %>% group_by(Aloja) %>% summarise(n= sum(Gente1), dias= mean(Estadia), Gastos= sum(Gasto))
 
alojamiento <- by_Aloja %>%  mutate(Gastos_P = Gastos/n) %>% mutate(Gastos_PDia = Gastos_P/dias )%>% xtable()

print(xtable(alojamiento))
 
 
```

VISITANTES INGRESADOS A URUGUAY, POR ZONA DE INGRESO, ESTADÍA Y GASTO

```{r,echo=FALSE, results='asis'}
options(xtable.comment = FALSE)

 x <-  by_Entro <- t4.2015  %>% mutate(Gente1= Gente*coef) %>% select(Entro, Gente1) %>% group_by(Entro) %>% summarise(n= sum(Gente1)) %>% xtable()
 
 print(xtable(x))
 
```


